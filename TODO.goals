Consider replacing multiprocessing with asyncio or anyio where appropriate
Add unit tests
