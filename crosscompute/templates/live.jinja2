{% extends BASE_JINJA2 %}

{% block body_js %}
let serverTimestamp = {{ timestamp_value }};

setInterval(async function() {
  let response = await fetch('{{ BASE_URI }}{{ MUTATIONS_ROUTE }}');
  const d = await response.json();
  if (serverTimestamp === d.server_timestamp) return;
  response = await fetch(location.href, { method: 'head' });
  if (response.ok) {
    location.reload();
  } else {
    location.href = '/';
  }
}, {{ PING_INTERVAL_IN_MILLISECONDS }});
{{ super() }}
{%- endblock %}
